<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Streamers on Twitch</title>
    <!-- Add Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1 class="mt-4">Active Minecraft Streamers on Twitch</h1>
        <div id="streamers" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 mt-4"></div>
    </div>

    <!-- Add Bootstrap JavaScript and its dependencies -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

    <script>
        async function fetchMinecraftStreamers() {
            const response = await fetch("/api/getMinecraftStreamers");
            const streamers = await response.json();
            displayStreamers(streamers);
        }

        function displayStreamers(streamers) {
            const streamersContainer = document.getElementById("streamers");

            streamers.forEach(streamer => {
                const col = document.createElement("div");
                col.className = "col";

                const card = document.createElement("div");
                card.className = "card h-100";

                const iframe = document.createElement("iframe");
                iframe.src = `https://player.twitch.tv/?channel=${streamer.user_name}&parent=${location.hostname}&autoplay=false`;
                iframe.allowFullscreen = true;
                iframe.className = "embed-responsive-item";

                const cardBody = document.createElement("div");
                cardBody.className = "card-body";

                const cardTitle = document.createElement("h5");
                cardTitle.className = "card-title";
                cardTitle.textContent = streamer.user_name;

                cardBody.appendChild(cardTitle);
                card.appendChild(iframe);
                card.appendChild(cardBody);
                col.appendChild(card);
                streamersContainer.appendChild(col);
            });
        }

        fetchMinecraftStreamers();
    </script>
</body>
</html>
